$(document).ready(function () { var owidth = 1920; var oheight = 550; var indexconwidth = 653; var indexconnow = 0; var indexconmax = $(".topindexgroup .cen .panel .items").length; var indexconsession = null; var indextimespan = 5000; var swidth = $("body").width(); if (owidth != swidth) { $(".flicker-example").css("height", parseInt(owidth / swidth * oheight) + "px"); } $(".topindexgroup .rightbtn").bind("click", function () { if (!$(".topindexgroup .cen .panel").is(":animated")) { clearInterval(indexconsession); indexconnext(); indexconsession = setInterval(function () { indexconnext(); }, indextimespan); } }); $(".topindexgroup .leftbtn").bind("click", function () { if (!$(".topindexgroup .cen .panel").is(":animated")) { clearInterval(indexconsession); indexconprev(); indexconsession = setInterval(function () { indexconnext(); }, indextimespan); } }); $(".topindexgroup .menu span").bind("click", function () { if (!$(".topindexgroup .cen .panel").is(":animated")) { var objindex = $(".topindexgroup .menu span").index($(this)); if (objindex != indexconnow) { clearInterval(indexconsession); if (objindex > indexconnow) { $(".topindexgroup .cen .panel").prepend($("#item" + objindex)).prepend($(".topindexgroup .cen .panel .items:eq(1)")); $(".topindexgroup .cen .panel").animate({ "margin-left": (0 - indexconwidth) + "px" }, 300, function () { $(".topindexgroup .cen .panel").css("margin-left", "0"); indexconsort(objindex); indexconnow = objindex; indexconmenuchg(); }); } else { $(".topindexgroup .cen .panel").prepend($("#item" + objindex)).css("margin-left", (0 - indexconwidth) + "px"); $(".topindexgroup .cen .panel").animate({ "margin-left": "0" }, 300, function () { indexconsort(objindex); indexconnow = objindex; indexconmenuchg(); }); } indexconsession = setInterval(function () { indexconnext(); }, indextimespan); } } }); function indexconsort(objid) { $(".topindexgroup .cen .panel").prepend($("#item" + objid)); for (var i = 0; i < indexconmax; i++) { if (i > objid) { $(".topindexgroup .cen .panel").append($("#item" + i)); } } for (var i = 0; i < indexconmax; i++) { if (i < objid) { $(".topindexgroup .cen .panel").append($("#item" + i)); } } } function indexconnext() { if (!$(".topindexgroup .cen .panel").is(":animated")) { indexconnow++; if (indexconnow >= indexconmax) { indexconnow = 0; } $(".topindexgroup .cen .panel").animate({ "margin-left": (0 - indexconwidth) + "px" }, 300, function () { $(".topindexgroup .cen .panel").append($(".topindexgroup .cen .panel .items:eq(0)")).css("margin-left", "0"); indexconmenuchg(); }); } } function indexconprev() { if (!$(".topindexgroup .cen .panel").is(":animated")) { indexconnow--; if (indexconnow < 0) { indexconnow = indexconmax - 1; } $(".topindexgroup .cen .panel").prepend($(".topindexgroup .cen .panel .items:eq(" + (indexconmax - 1) + ")")).css("margin-left", (0 - indexconwidth) + "px"); $(".topindexgroup .cen .panel").animate({ "margin-left": "0" }, 300, function () { indexconmenuchg(); }); } } function indexconmenuchg() { $(".topindexgroup .menu span:eq(" + indexconnow + ")").addClass("in").removeClass("out").siblings().addClass("out").removeClass("in"); } indexconsession = setInterval(function () { indexconnext(); }, indextimespan); var indexfilm = 0; var filmsesstion = null; var ow = owidth; var oh = oheight; var inttimespan = 5000; var swidth = ow; var sheight = oh; function filmdo() { indexfilm++; if (indexfilm >= $(".indexfilm>.panel>.items>div").length) { indexfilm = 0; } $(".indexfilm>.panel>.group").append($(".indexfilm>.panel>.items>div").eq(indexfilm).html()); $(".indexfilm>.panel").stop(true, true).animate({ "scrollLeft": swidth }, 500, function () { $(".indexfilm>.panel>.group").find("a").eq(0).remove(); $(".indexfilm>.panel").scrollLeft(0); $(".indexfilm>.panel>.filmmenu>ul>li").eq(indexfilm).addClass("in").removeClass("out").siblings().addClass("out").removeClass("in"); }); } function chkflimmenu() { var $objmenu = $(".indexfilm>.panel>.filmmenu"); var $objoff = $(".indexfilm").offset(); var $objw = $(document).width(); if ($objw != swidth) { swidth = $objw; sheight = parseInt($objw / ow * oh); $(".indexfilm,.indexfilm div.panel,.indexfilm div.panel .group").css("height", sheight + "px"); $(".indexfilm div.panel").css("width", swidth + "px"); $(".indexfilm div.panel .group").css("width", (swidth * 2) + "px"); $(".indexfilm .panel .group img").css("width", swidth + "px").css("height", sheight + "px"); for (var i = 0; i < $(".indexfilm>.panel>.items>div").length; i++) { $(".indexfilm>.panel>.items>div:eq(" + i + ") img").css("width", swidth + "px").css("height", sheight + "px"); } if (swidth > 980) { $objmenu.css("left", (((swidth - parseInt($objmenu.width())) / 2) + 15) + "px").css("top", ($objoff.top + sheight - 25) + "px"); } else { $objmenu.css("left", "15px").css("top", ($objoff.top + sheight - 35) + "px"); } } } function filmsel($obj) { var menuindex = $(".indexfilm>.panel>.filmmenu>ul>li").index($obj); clearInterval(filmsesstion); if (menuindex == indexfilm) { } else { if (!$(".indexfilm>.panel").is(":animated")) { menuindex--; indexfilm = menuindex; filmdo(); } } } $(".indexfilm>.panel>.filmmenu>ul>li").bind("mouseover", function () { filmsel($(this)); }).bind("mouseout", function () { filmsesstion = setInterval(function () { filmdo(); }, inttimespan); }); setInterval(function () { chkflimmenu(); }, 100); filmsesstion = setInterval(function () { filmdo(); }, inttimespan); });